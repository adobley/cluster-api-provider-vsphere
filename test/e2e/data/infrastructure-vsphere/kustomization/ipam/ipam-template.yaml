---
apiVersion: infrastructure.cluster.x-k8s.io/v1beta1
kind: VSphereMachineTemplate
metadata:
  name: ${CLUSTER_NAME}
  namespace: ${NAMESPACE}
spec:
  template:
    spec:
      network:
        devices:
          - nameservers: ["${NODE_IPAM_NAMESERVER}"]
            addressesFromPools:
            - name: inclusterippool
              apiGroup: ipam.cluster.x-k8s.io
              kind: InClusterIPPool
            networkName: '${VSPHERE_NETWORK}'
---
apiVersion: infrastructure.cluster.x-k8s.io/v1beta1
kind: VSphereMachineTemplate
metadata:
  name: ${CLUSTER_NAME}-worker
  namespace: ${NAMESPACE}
spec:
  template:
    spec:
      network:
        devices:
          - nameservers: ["${NODE_IPAM_NAMESERVER}"]
            addressesFromPools:
            - name: inclusterippool
              apiGroup: ipam.cluster.x-k8s.io
              kind: InClusterIPPool
            networkName: '${VSPHERE_NETWORK}'
